# 路径

学到`File`类的时候，发现搞不明白各种路径，所以专门写一篇介绍各种各样眼花缭乱的路径。

## Windows和Unix/Linux中的路径
### Windows下
#### 绝对路径
平常我们说的绝对路径是指这种：`C:\Windows\System32\calc.exe`，另外下面还要两种特殊的路径也是属于绝对路径。
###### UNC（Universal Naming Convention通用命名规范）路径
UNC路径用于在局域网上定位文件或文件夹，在通过网上邻居访问其它系统上的共享文件时使用的就是UNC路径。UNC路径的格式如下：
`\\PC101\ShareFiles\job.doc`，其中PC101是目标系统的计算机名，ShareFiles是目标系统上的共享文件夹名称。

#### 以`\\?\`开头的路径
在某些手工辅助杀毒的工具中可以看到以`\\?\`头的路径。完整路径和UNC路径都可以以`\\?\`开头：
```java
\\?\C:\Windows\System32\calc.exe
\\?\UNC\PC101\ShareFiles\job.doc
```

#### 相对路径
这种路径需要与进程的当前文件夹（Current directory）一起合作才可以定位一个文件或文件夹。进程的当前文件夹并不是指EXE文件所在的文件夹，它是每个进程都有的一个属性。例如在命令提示符中显示的路径就是这个cmd.exe进程的当前文件夹，使用cd命令可以改变当前文件夹，无论当前文件夹如何改变，cmd.exe文件所在的文件夹总是不变的。在进程启动的时候可以指定它的当前文件夹，例如在快捷方式的属性中有一个“起始位置”输入框，这个就是进程启动后的当前文件夹。如果在启动时不指定进程的当前文件夹（直接双击EXE文件的情况），那么EXE文件的所在文件夹就会作为它的当前文件夹。纯粹的相对路径格式例如：`Windows\System32\calc.exe`，注意最前面不能有`\`，否则将会变成另一种路径。

#### 以`\`开头的路径
在windows下，如果以`\`开头，它就表示**相对于当前文件夹根目录**的路径。例如进程的当前文件夹是`C:\Windows`，那么`\System32\calc.exe`就表示`C:\System32\calc.exe`。不论当前文件夹的路径有多深，只取根目录进行合并。

#### 以盘符和冒号开头的路径
类似于`C:System32\calc.exe`，乍一看，这好像是拼写错误的绝对路径。其实不是，盘符加冒号是一种特殊的表示法，表示的是进程在“该分区上的当前文件夹”。这里的"当前文件夹"，这与上文的"当前文件夹"是不同的。简单来说，对于每一个分区，进程都会保存在这个分区上最后使用的当前文件夹。

例如：运行cmd，执行`cd C:\Windows\System32`命令进入该文件夹，然后切换到其它的分区，再执行`C:calc.exe`命令，可以看到计算器程序启动了。 为什么？

我们在执行cd命令进入`C:\Windows\System32`文件夹后，进程便以此为当前文件夹，当切换到其他的分区时，进程先将这个文件夹的路径保存起来，再进行切换。使用盘符和冒号的形式读取指定分区上的当前文件夹。

### Unix/Linux下

路径的概念都是一样的，有几点不同。

在Unix/Linux中，路径的分隔采用正斜杠`/`，比如`/home/fzu`；而在Windows中，路径分隔采用反斜杠`\`，比如`D:\tools\eclipse`。由于存在转义的问题，所以windows下的路径经常会用双反斜杠来表示，不管解析引擎是否将反斜杠解析成转义字符，最终在内存中得到的都是`\`，因此写成`D:\\tools\\eclipse`是不会出问题的。

linux下相对路径的表示：
* `.` 表示用户所处的当前目录；
* `..`表示上级目录；
* `_` 表示前一个工作目录；
* `~` 表示当前用户自己的根目录；
* `~account` 表示[account]这个用户的根目录。



## 路径的限制

路径的写法有很多的限制：
* 长度限制：除了以`\\?\`开头的路径之外，其它路径的长度都不能超过260个字符（包括结尾的`\0`字符），而`\\?\`开头的路径长度可以达到约32000个字符（系统在处理`\\?\`前缀的时候可能将它扩展成更长的字符串）。网络上流传的一则技巧：文件路径太长而不能被删除，可以在执行del命令时在路径前加上`\\?\`前缀。
* 句点： 文件或文件夹名称的最后一个字符不能为空格或句点。但在路径中，最后一个字符可以为句点(英文句点)，因为路径中的**句点表示的是当期文件夹（这与上文的当前文件夹完全不同）**，**两个句点表示的是上一级文件夹**。以`\\?\`开头的路径中不能使用句点表示当前文件夹或上一级文件夹，在资源管理器的地址栏中虽然可以这么做，那是因为资源管理器对其作了处理。
* 特殊字符：
  - 文件或文件夹名称不能包含的字符 ：`< > : " / \ | ? *`
  - 在路径中可以使用 `: \ ?`，冒号是与盘符一起使用的，问号是`\\?\`前缀中特有的，除此之外不能出现这两个字符；而`\`是文件夹分割符。虽然我们也能使用`/`作为分隔符，实际上这是不允许的，系统在处理路径时会将`/`替换成`\`。另外，如果路径最后一个字符是`\`，那么该路径表示的是文件夹；否则表示的是一个文件。
  - UNC路径的计算机名部分不能出现以下字符：`` ~ ! @ # $ % ^ & * ( ) = + _ [ ] { } \ | ; : . ‘ “ , < > / ?`，确实是够多的了，实际上标准的计算机名推荐只使用26个英文字母、10个数字以及-（连字符），否则可能会出现找不到计算机的情况。在更改计算机名的时候如果出现非标准字符，系统会作出提示。

参考：
* [windows和linux下的文件路径表示小结](http://blog.csdn.net/qq_25223941/article/details/49927339)
